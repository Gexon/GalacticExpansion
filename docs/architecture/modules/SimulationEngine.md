# Модуль `SimulationEngine`

**Ответственность**: управляет “жизненным циклом” симуляции GLEX: тик/таймер, планирование действий, координация модулей.  
**Аудитория**: разработчики.  
**Статус**: draft.  
**Связанные документы**: [`../03_Технический_проект.md`](../03_Технический_проект.md), [`../../config/state_schema.md`](../../config/state_schema.md).  

## Входы

- События Empyrion (`Game_Event`), нормализованные шлюзом (`EmpyrionGateway`).
- Текущее состояние симуляции (`state.json` через `StateStore`).
- Конфигурация (лимиты/интервалы/флаги включения механик).

## Выходы

- План действий (что сделать на этом тике):
  - spawn/destroy/teleport сущностей (через `SpawningAndEvolution`),
  - AIM-команды (через `AimOrchestrator`),
  - обновления state (через `StateStore`).

## Инварианты (обязательные правила)

- Не допускаем “бурстов” запросов к серверу: любые массовые действия размазываются по тикам.
- Все обращения к ModAPI идут через `EmpyrionGateway`.
- Любые консольные команды — только через `AimOrchestrator` (whitelist + rate limit).

## Edge cases

- Playfield выгружен (нет игроков): активные действия на таком playfield должны быть либо запрещены, либо отложены.
- Отсутствуют данные об entity/структуре: не делаем предположений, запрашиваем информацию и логируем.

## Логи (что обязательно логировать)

- старт/остановка цикла (Game_Start/Game_Exit);
- “решения” симуляции: смены Stage, постановка задач build/upgrade/rebuild;
- причины отказов (лимиты, rate limit, невалидный конфиг, невозможность спавна).