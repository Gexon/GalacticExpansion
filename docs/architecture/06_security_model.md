# Модель безопасности (GLEX)

**Назначение**: зафиксировать правила безопасности и защиту от злоупотреблений.  
**Аудитория**: разработчики.  
**Статус**: draft.  
**Связанные документы**: [`../ops/Operations_Runbook.md`](../ops/Operations_Runbook.md), [`../config/ConfigReference.md`](../config/ConfigReference.md).  

## Поверхности атаки (attack surface)

В контексте Empyrion ModAPI самая критичная поверхность атаки/ошибки:

- `Request_ConsoleCommand` (в частности, вызовы AIM через `aim ...`),
- массовые/частые `Game_Request` (DoS на серверную сторону, лаги),
- состояние `state.json` и конфиги (вредоносные/битые значения).

## Принципы защиты

### 1) Whitelist команд

Разрешены только:

- строго ограниченный набор `aim ...` команд (перечень уточняется при реализации),
- опционально `say ...` (если нужно, но по умолчанию выключено).

Любая команда, не прошедшая whitelist, **не отправляется** на сервер и **логируется**.

### 2) Rate limiting

Из требований:

- `MaxAIMCommandsPerMinute`
- общий rate limit на requests к серверу (шлюз запросов)

### 3) Валидация конфигов

- числовые лимиты должны иметь разумные min/max,
- строки (имена playfield/prefab) валидируются на “пусто/непусто” и допустимые символы,
- при ошибке конфиг не “роняет” сервер: лог + fallback значения/отключение фичи.

### 4) Прозрачный аудит

В логах должно быть видно:

- кто/почему инициировал AIM (какая подсистема/событие),
- какая команда была отправлена (в безопасном виде),
- какой лимит сработал (если команда заблокирована).
